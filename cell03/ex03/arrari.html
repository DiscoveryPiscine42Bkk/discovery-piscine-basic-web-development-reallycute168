<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>To do or not to do</title>
</head>
<body>

  <button id="newBtn">New</button>
  <div id="ft_list"></div>

  <script>
  window.onload = function () {
  loadTodos();

  document.getElementById('newBtn').addEventListener('click', function () {
    let todoText = prompt("Enter your new TO DO:");
    if (todoText && todoText.trim() !== "") {
      addTodo(todoText.trim());
      saveTodos();
    }
  });
};

function addTodo(text) {
  const ftList = document.getElementById('ft_list');
  const todo = document.createElement('div');
  todo.className = 'todo';
  todo.textContent = text;

  // เมื่อคลิกเพื่อ "ลบ"
  todo.addEventListener('click', function () {
    const confirmDelete = confirm("Do you want to delete this TO DO?");
    if (confirmDelete) {
      ftList.removeChild(todo);
      saveTodos();
    }
  });

  ftList.appendChild(todo); // ใช้ column-reverse เพื่อให้รายการใหม่อยู่บน
}

function saveTodos() {
  const todos = [];
  const todoElements = document.querySelectorAll('#ft_list .todo');
  todoElements.forEach(todo => todos.push(todo.textContent));
  document.cookie = "todos=" + encodeURIComponent(JSON.stringify(todos)) + "; path=/";
}

function loadTodos() {
  const cookies = document.cookie.split("; ");
  const todoCookie = cookies.find(row => row.startsWith("todos="));
  if (todoCookie) {
    const value = decodeURIComponent(todoCookie.split("=")[1]);
    try {
      const todos = JSON.parse(value);
      todos.forEach(todoText => addTodo(todoText));
    } catch (e) {
      console.error("Error loading todos:", e);
    }
  }
}
</script>

</body>
</html>